<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en"><generator uri="https://jekyllrb.com/" version="4.3.4">Jekyll</generator><link href="https://sus-admin.github.io/feed.xml" rel="self" type="application/atom+xml"/><link href="https://sus-admin.github.io/" rel="alternate" type="text/html" hreflang="en"/><updated>2024-10-17T07:44:50+00:00</updated><id>https://sus-admin.github.io/feed.xml</id><title type="html">sus-admin</title><subtitle>various detailed technical procedures for system, server, and network admin and development. Based on [*folio](https://github.com/bogoli/-folio) design. </subtitle><entry><title type="html">Cobbler 3.3.6 Beginner’s Guide</title><link href="https://sus-admin.github.io/blog/2024/Cobbler-3.3.6-Beginners-Guide/" rel="alternate" type="text/html" title="Cobbler 3.3.6 Beginner’s Guide"/><published>2024-10-16T00:00:00+00:00</published><updated>2024-10-16T00:00:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/Cobbler-3.3.6-Beginners-Guide</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/Cobbler-3.3.6-Beginners-Guide/"><![CDATA[<p>This guide is intended to accompany and extend the official Cobbler <a href="https://cobbler.readthedocs.io/en/v3.3.6/installation-guide.html">Installation</a> and <a href="https://cobbler.readthedocs.io/en/v3.3.6/quickstart-guide.html">Quick Start</a> guides.</p> <p>It is recommended to review the above official guides before getting started with any Cobbler installation/deployment. This guide will provide some additional context and procedures for getting started with Cobbler v3.3.6 on a Fedora 34 host system.</p> <h3 id="objective"><strong>Objective</strong></h3> <p>Starting with a fresh installation of Fedora 34 Server (or Workstation - <a href="https://archives.fedoraproject.org/pub/archive/fedora/linux/releases/34/Server/x86_64/iso/">Fedora download archive</a>), this guide will detail preparing the Fedora 34 system for Cobbler 3.3.6 installation from source, including prerequisite installations and network setup, and then provide all necessary steps to install and configure Cobbler to automatically provision another LAN host with Fedora 34 or 37 Server through PXE network boot.</p> <h3 id="environment"><strong>Environment</strong></h3> <p>Although Cobbler’s <a href="https://cobbler.readthedocs.io/en/v3.3.6/installation-guide.html#id2">official docs</a> advise that installing and running Cobbler in a virtual environment is not possible, I have done extensive testing with this scenario and have had no issues related to virtualization. It seems that Cobbler can run on several different Linux distributions, installed on either physical or virtual hardware, and you may find success with different environments from what this document details, but for consistency, this document assumes that the <strong>Cobbler Server</strong> <em>(Fedora 34 Server)</em> is installed as a <strong>VirtualBox VM</strong> under a <strong>Windows 10 host</strong>.</p> <p>The Cobbler server VM is configured as a <strong>UEFI system</strong>, with <strong>64 GB HDD</strong>, <strong>4 GB RAM</strong>, <strong>2 vCPUs</strong>, and <strong>2 virtual network adapters.</strong> 1 of the VM’s network adapters is configured as a <strong><em>Bridged Adapter</em></strong> connected to the primary physical NIC on the Windows host so that SSH to the Cobbler server will be more accessible. The other network adapter is configured as a VirtualBox <strong><em>Internal Network</em></strong> adapter named <strong><em>“cobbler”</em></strong> which will have no external network connectivity (closed LAN; no internet access).</p> <p>The <strong>PXE client</strong> <em>(the target for network installations)</em> is also running as a <strong>VirtualBox VM</strong> under the <strong>same Windows 10 host</strong>; it has <strong>32 GB HDD</strong>, <strong>4 GB RAM</strong>, <strong>2 vCPUs</strong>, and <strong>1 virtual network adapter</strong> which is connected to the <strong><em>same “cobbler” VirtualBox “Internal Network” adapter</em></strong> that the Cobbler server is connected to, described above.</p> <p>This exact configuration is not a strict requirement for deploying systems through Cobbler, but proves that a local network PXE client is able to boot and install an operating system without public internet connectivity, using only the resources immediately available on the VM and the Cobbler server. The Cobbler server will use the internet to install initial updates, patches, prerequisites, the Cobbler application, and download the desired OS installation media (.iso files) for the PXE client, but no systems will require an internet connection at the time of PXE client network installs if configured 1-for-1 with this document.</p> <h4 id="physical-network-diagram">Physical Network Diagram</h4> <p><img src="/images/Cobbler-3.3.6-Beginners_Physical.jpg" alt="Cobbler-3.3.6-Beginners_Physical.drawio"/></p> <h4 id="logical-network-diagram">Logical Network Diagram</h4> <p><img src="/images/Cobbler-3.3.6-Beginners_Logical.jpg" alt="Cobbler-3.3.6-Beginners_Logical.drawio"/></p> <h3 id="fedora-34-server-prep"><strong>Fedora 34 Server Prep</strong></h3> <p>As stated above, this document outlines the procedures necessary to install and configure Cobbler v3.3.6 on a Fedora 34 host server for local network installations/provisioning through PXE. Additionally, necessary adjustments will be made to allow for compatible operations with <strong>selinux</strong> and <strong>firewalld</strong> on the Cobbler server. As such, being that this is a beginner’s guide, it is recommended to keep things simple and <strong>limit the number of additional applications installed</strong> to the Fedora 34 Cobbler server to <strong>minimize unexpected firewall and selinux complications.</strong></p> <h4 id="initial-updates">Initial Updates</h4> <p>If Cobbler is to be installed on a Fedora 34 Server host, and automatic partitioning was used during initial OS installation, be sure to extend the LVM Logical Volme to a more usable capacity (recommended 95%):</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lvextend /dev/mapper/fedora_<span class="nv">$USER</span><span class="nt">-root</span> <span class="nt">-l</span>+95%FREE <span class="nt">-r</span>
</code></pre></div></div> <p>Update the Fedora 34 host with the latest YUM repo updates:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum update <span class="nt">-y</span>
</code></pre></div></div> <p>Install <strong>VirtualBox VM Guest Additions</strong>, either from the YUM repos, or the Guest Adds. CD included with “Oracle VM VirtualBox Manager” Windows application <em>(YUM method is shown below, but VirtualBox usually recommends using the Guest Adds. CD)</em>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> virtualbox-guest-additions
</code></pre></div></div> <p>Confirm SSH is enabled on the system, allowing for remote administration of the Cobbler server without the need to access the VM virtual display/monitor:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl <span class="nb">enable</span> <span class="nt">--now</span> ssh
</code></pre></div></div> <p>Install your preferred Linux sys admin tools, for example:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> neovim fzf tmux htop
</code></pre></div></div> <h3 id="security-hardening"><strong>Security Hardening</strong></h3> <p>SELinux and firewall operations can seem daunting at first, especially with an application as complex as Cobbler, but rest assured getting started with these security tools is only a matter of a few simple commands.</p> <h4 id="selinux">SELinux</h4> <p>Selinux should come enabled by default on a fresh Fedora 34 Server installation. Verify that the following command returns “enforcing” or “permissive” if you are unsure:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>getenforce
</code></pre></div></div> <p>If the <code class="language-plaintext highlighter-rouge">getenforce</code> command returns “enforcing”, skip to the <strong>Cobbler SELinux Config</strong> section below. If “permissive” is returned, skip to <strong>Enforcing SELinux</strong> section below.</p> <h5 id="enabling-selinux">Enabling SELinux</h5> <p>If the above command returns “disabled” selinux may be disabled on the kernel command line at boot time. Verify that selinux is not disabled via the kernel boot parameters:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /proc/cmdline
</code></pre></div></div> <p>If “selinux” is set to “0” in the output of the above command, follow the instructions found in the “/etc/selinux/config” file for the <code class="language-plaintext highlighter-rouge">grubby</code> command to enable selinux at boot time. The kernel command line parameters will take precedence over the below configuration, so be sure it is enabled.</p> <p>If SELinux was disabled at the kernel command line or in the “/etc/selinux/config” file, be sure to create the “.autorelabel” file at the root of the filesystem, and set SELINUX mode to “permissive” and NOT “enforcing” in the “/etc/selinux/config” file so that the file system is relabeled appropriately during the next boot. If SELinux is disabled, the filesystem will not contain any SELinux security context labels, preventing the system from booting properly if SELinux loads as “enforcing” during the next boot.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="nt">-E</span> <span class="s2">"s/SELINUX=(disabled|enforcing)/SELINUX=permissive/"</span> /etc/selinux/config
<span class="nb">touch</span> /.autorelabel
</code></pre></div></div> <p>With selinux enabled at the kernel command line and set to permissive in “/etc/selinux/config” <strong>reboot the Fedora 34 Cobbler server</strong> and observe the filesystem relabel as the system boots.</p> <h5 id="enforcing-selinux">Enforcing SELinux</h5> <p>Change the active runtime state/mode of SELinux to “enforcing”:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setenforce enforcing
</code></pre></div></div> <p>Configure SELInux to operate in “enforcing” mode at system boot time:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s1">'s/SELINUX=permissive/SELINUX=enforcing/'</span> /etc/selinux/config
</code></pre></div></div> <h5 id="cobbler-selinux-config">Cobbler SELinux Config</h5> <p>WIth SELinux operating in <strong>Enforcing</strong> mode, enable the necessary SELinux Booleans which will allow for basic operation of Cobbler:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>setsebool <span class="nt">-P</span> cobbler_can_network_connect 1
setsebool <span class="nt">-P</span> httpd_can_network_connect_cobbler 1
setsebool <span class="nt">-P</span> httpd_serve_cobbler_files 1
</code></pre></div></div> <h4 id="firewalld">Firewalld</h4> <p>There are many options for firewall solutions in Linux, but these procedures will detail how to configure <strong>firewalld</strong> to permit appropriate network traffic for normal Cobbler operations. Firewalld is the default firewall installed on Fedora and most Red Hat distros, verify that it is enabled and running:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl <span class="nb">enable</span> <span class="nt">--now</span> firewalld
</code></pre></div></div> <p>This document will refer to the network interface with internet access as the <strong>Main Fedora Server Interface</strong> and the NIC that will serve the PXE clients will be referred to as the <strong>Main Cobbler Server Interface.</strong></p> <p>The <strong>Main Fedora Server Interface</strong> <em>(“enp0s3” in my case, but your interface name may vary)</em> will be left on DHCP to minimize additional configurations, but could be set statically if desired.</p> <p>The <strong>Main Cobbler Server Interface</strong> <em>(“enp0s8” in my case, but your interface name may vary)</em> is configured with an IP address of <strong>10.0.0.10/24</strong> with no gateway, since there are not additional networks reachable over that interface.</p> <blockquote> <p>Reference the logical network diagram above for more context regarding the interface configurations.</p> </blockquote> <p>Create a new <strong>firewalld</strong> <strong><em>zone</em></strong> which the <strong>Main Cobbler Server Interface</strong> will operate in:</p> <blockquote> <p>Linux ISC DHCP server opens a raw UDP socket with the Linux kernel, bypassing the firewalld rules, so it is not necessary to allow the service/port. Be sure the resulting “/etc/dhcp/dhcpd.conf” file is only configured for the desired interface for hosting DHCP <strong><em>(Main Cobbler Server Interface).</em></strong></p> <ul> <li> <p>https://serverfault.com/questions/191390/iptables-and-dhcp-questions/</p> </li> <li> <p>https://unix.stackexchange.com/questions/447440/ufw-iptables-not-blocking-dhcp-udp-port-67</p> </li> </ul> </blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>firewall-cmd <span class="nt">--permanent</span> <span class="nt">--new-zone</span><span class="o">=</span>cobbler
firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>cobbler <span class="nt">--set-target</span><span class="o">=</span>DROP
firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>cobbler <span class="nt">--add-service</span><span class="o">=</span>ssh
firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>cobbler <span class="nt">--add-service</span><span class="o">=</span>tftp
firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>cobbler <span class="nt">--add-service</span><span class="o">=</span>http
firewall-cmd <span class="nt">--permanent</span> <span class="nt">--zone</span><span class="o">=</span>cobbler <span class="nt">--add-service</span><span class="o">=</span>https
firewall-cmd <span class="nt">--reload</span>
</code></pre></div></div> <p>For simplicity, the <strong>Main Fedora Server Interface</strong> can be left in the <strong>default firewalld zone</strong></p> <blockquote> <p>Verify the currrent active zones with the following command <em>(OS default should be “FedoraServer”)</em>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>firewall-cmd <span class="nt">--get-active-zones</span>
</code></pre></div> </div> </blockquote> <p>Reconfigure the <strong>Main Cobbler Server Interface</strong> to operate in the new “cobbler” firewalld zone</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmcli con mod enp0s8 connection.zone cobbler
</code></pre></div></div> <blockquote> <p>Feel free to comment with additional security hardening measures you would employ in this environment.</p> </blockquote> <h3 id="prerequisites"><strong>Prerequisites</strong></h3> <blockquote> <p>Now would be a good time to reboot to load a new kernel that was likely installed with the <code class="language-plaintext highlighter-rouge">yum update</code> command used above, as well as shutting down the Cobbler server to take a snapshot in VirtualBox.</p> </blockquote> <p>if the <strong>~/Downloads</strong> directory does not exist on the Cobbler server yet, create it, then download the Fedora 34 &amp; 37 installation media (.iso files):</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span> <span class="nt">-d</span> ~/Downloads <span class="o">]</span> <span class="o">||</span> <span class="nb">mkdir</span> ~/Downloads
<span class="nb">cd</span> ~/Downloads <span class="o">&amp;&amp;</span> wget https://archives.fedoraproject.org/pub/archive/fedora/linux/releases/34/Server/x86_64/iso/Fedora-Server-dvd-x86_64-34-1.2.iso
<span class="nb">cd</span> ~/Downloads <span class="o">&amp;&amp;</span> wget https://archives.fedoraproject.org/pub/archive/fedora/linux/releases/37/Server/x86_64/iso/Fedora-Server-dvd-x86_64-37-1.7.iso
</code></pre></div></div> <p>Install prereqs for installing Cobbler from Source</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> make git python3-devel python3-sphinx python3-coverage openssl httpd-devel
</code></pre></div></div> <blockquote> <p>Cobbler is also available through the YUM repos, using <code class="language-plaintext highlighter-rouge">yum install cobbler</code></p> </blockquote> <p>create a directory to store the Cobbler source code prior to installing</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> /usr/src/cobbler
<span class="nb">cd</span> /usr/src/cobbler
wget <span class="nt">-P</span>  ~/Downloads/. https://github.com/cobbler/cobbler/archive/refs/tags/v3.3.6.zip
unzip <span class="nt">-d</span> <span class="nb">.</span> ~/Downloads/v3.3.6
</code></pre></div></div> <p>Install the runtime prereqs and enable system services</p> <blockquote> <p>some prereqs are missing from the official <a href="https://cobbler.readthedocs.io/en/v3.3.6/installation-guide.html#packages">Cobbler docs</a>.</p> <p>have a look at the <a href="https://github.com/cobbler/cobbler/blob/v3.3.6/docker/rpms/Fedora_34/Fedora34.dockerfile">dockerfile</a> located in the Cobbler source code for a more complete list.</p> </blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> httpd wget curl rsync dnf-plugins-core dosfstools createrepo_c xorriso python3-mod_wsgi python-cheetah python3-pyyaml python-netaddr python-librepo python-schema syslinux tftp-server dhcp-server pykickstart ipxe-bootimgs ipxe-roms koan mod_ssl python3-pyflakes python3-pycodestyle rpm-build python3-dns python3-file-magic python3-pymongo
systemctl <span class="nb">enable</span> <span class="nt">--now</span> httpd tftp dhcpd
</code></pre></div></div> <blockquote> <p>Systemd may return some errors when attempting to enable the above services, this is expected since DHCP is not configured yet.</p> </blockquote> <p>Install the GRUB bootloader and module packages so GRUB can be used as the network bootloader for PXE clients:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> grub2-pc grub2-pc-modules grub2-efi-x64-modules grub2-efi-aa64-modules grub2-efi-arm-modules grub2-efi-ia32-modules grub2-emu-modules grub2-emu-modules grub2-ppc64le-modules grub2-emu
</code></pre></div></div> <h3 id="cobbler-installation-and-basic-configuration"><strong>Cobbler Installation and Basic Configuration</strong></h3> <p>Install Cobbler</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /usr/src/cobbler/cobbler-3.3.6
make <span class="nb">install
</span>systemctl restart httpd
</code></pre></div></div> <p>Reconfigure the <strong>cobblerd</strong> daemon as described in Cobbler’s <a href="https://cobbler.readthedocs.io/en/v3.3.6/installation-guide.html#id3">official docs</a>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s,usr/bin/cobblerd,usr/local/bin/cobblerd,"</span> /etc/cobbler/cobblerd.service
<span class="nb">cp</span> /etc/cobbler/cobblerd.service /etc/systemd/system/.
systemctl daemon-reload
systemctl <span class="nb">enable </span>cobblerd
</code></pre></div></div> <p>Reconfigure the default Cobbler settings file to match the local server:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/manage_dhcp: false/manage_dhcp: true/"</span> /etc/cobbler/settings.yaml
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/dhcp_v4: false/dhcp_v4: true/"</span> /etc/cobbler/settings.yaml
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/server: 127.0.0.1/server: 10.0.0.10/"</span> /etc/cobbler/settings.yaml
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/next_server_v4: 127.0.0.1/next_server_v4: 10.0.0.10/"</span> /etc/cobbler/settings.yaml
</code></pre></div></div> <p>Optionally, toggle some convenient settings:</p> <blockquote> <p>The PXE client software that comes with VirtualBox VM firmware (or NIC?) does not support HTTP as a download protocol, so it may be best to leave it disabled</p> <p>HTTP can always be utilized if you boot the PXE client from CD using the latest <a href="https://boot.ipxe.org/ipxe.iso">ipxe.iso</a></p> </blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/pxe_just_once: true/pxe_just_once: false/"</span> /etc/cobbler/settings.yaml
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/enable_ipxe: false/enable_ipxe: true/"</span> /etc/cobbler/settings.yaml
</code></pre></div></div> <p>Edit the subnet decaration in <strong>/etc/cobbler/dhcp.tempate</strong> to match the <strong>Main Cobbler Server Interface</strong> configuration (again, the PXE clients will not have an internet gateway or DNS in this example, so just align it with what would make sense for that interface):</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>subnet 10.0.0.0 netmask 255.255.255.0 <span class="o">{</span>
     option routers             10.0.0.1<span class="p">;</span>
     option domain-name-servers 10.0.0.1<span class="p">;</span>
     option subnet-mask         255.255.255.0<span class="p">;</span>
     range dynamic-bootp        10.0.0.100 10.0.0.199<span class="p">;</span>
</code></pre></div></div> <p>Cobbler should now be able to start up and run <strong><em>sync</em></strong> and <strong><em>check</em></strong> tasks without fatal errors:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart cobblerd <span class="o">&amp;&amp;</span> <span class="nb">sleep </span>10
cobbler <span class="nb">sync</span> <span class="o">&amp;&amp;</span> <span class="nb">sleep </span>5
cobbler check
cobbler mkloaders
</code></pre></div></div> <p>Pull the latest signatures from Cobbler GitHub</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cobbler signature update
</code></pre></div></div> <p>With SELinux enabled, some files generated/copied/moved by Cobbler will not retain the correct security context labels necessary for proper operation. create a Cobbler sync-trigger to correct the SELinux labels upon any and all successful completions of a Cobbler <strong><em>sync</em></strong> tasks</p> <blockquote> <p>Cobbler Triggers will run at different times depending on which directory they are placed in, and in alphabetical order within that directory. This sync-trigger specifically should typically be run after ALL sync tasks/triggers are completed</p> <p>Additionally, if there is an error with a <code class="language-plaintext highlighter-rouge">cobbler sync</code> task (trigger, or otherwise) before reaching this trigger, the sync task will terminate, and the trigger will not run, causing Cobbler files to not be relabeled appropriately… however, there are likely bigger issues at hand if the <code class="language-plaintext highlighter-rouge">cobbler sync</code> task is erroring out.</p> <p>More info on <a href="https://cobbler.readthedocs.io/en/v3.3.6/user-guide.html#triggers">Cobbler Triggers</a></p> </blockquote> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s1">'#!/bin/bash
restorecon -R /var/lib/tftpboot
restorecon -R /var/www/cobbler'</span> | <span class="nb">tee</span> /var/lib/cobbler/triggers/sync/post/zzz-selinux-restorecon

<span class="nb">chmod </span>u+x /var/lib/cobbler/triggers/sync/post/zzz-selinux-restorecon
</code></pre></div></div> <p>issue another <code class="language-plaintext highlighter-rouge">cobbler sync</code> to check for errors <em>(should show</em> <strong><em>*** TASK COMPLETE ***</em></strong><em>)</em>:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart cobblerd <span class="o">&amp;&amp;</span> <span class="nb">sleep </span>10
cobbler <span class="nb">sync</span>
</code></pre></div></div> <h3 id="importing-and-deploying-fedora-34-server"><strong>Importing and Deploying Fedora 34 Server</strong></h3> <p>Mount the Fedora 34 Server installation media</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> /mnt/Fedora
mount <span class="nt">-t</span> iso9660 <span class="nt">-o</span> loop,ro /home/fedora/Downloads/Fedora-Server-dvd-x86_64-34-1.2.iso /mnt/Fedora
cobbler import <span class="nt">--name</span><span class="o">=</span>Fedora34 <span class="nt">--arch</span><span class="o">=</span>x86_64 <span class="nt">--path</span><span class="o">=</span>/mnt/Fedora
</code></pre></div></div> <p>Inspect the imported Distribution</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cobbler distro report
</code></pre></div></div> <blockquote> <p>Optionally, remove the deprecated <strong><em>“tree”</em></strong> option from the Cobbler Distro <code class="language-plaintext highlighter-rouge">kernel-options</code> which can be used in the kickstart file instead. This option will be ignored anyway by the installer.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cobbler distro edit <span class="nt">--name</span> Fedora34-x86_64 <span class="nt">--kernel-options</span> <span class="s2">""</span>
</code></pre></div> </div> <blockquote> <p>cobbler still appropriately sets the “inst.repo” kernel-option in the GRUB or PXE kernel-options in at the <code class="language-plaintext highlighter-rouge">/var/lib/tftpboot/grub/x86_64_menu_items.cfg</code> &amp; <code class="language-plaintext highlighter-rouge">/var/lib/tftpboot/pxelinux.cfg/default</code> files. This is likey managed by the Cobbler <strong><em>“tree”</em></strong> variable in the Cobbler Profile, seen with the <code class="language-plaintext highlighter-rouge">cobbler profile report</code> command, or the Profile’s config file in <code class="language-plaintext highlighter-rouge">/var/www/cobbler/distro_mirror/config</code> directory</p> </blockquote> </blockquote> <p>Create a new generic Fedora 34 kickstart file from the sample included with Cobbler, removing some elements that will cause fatal errors diring install, as well as setting SELinux to permissive mode for deployed systems, and creating a new admin user named “fedora” which will allow for immediate SSH access to the installed system.</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /var/lib/cobbler/templates/sample.ks | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"</span><span class="se">\-</span><span class="s2">-useshadow"</span> | <span class="nb">grep</span> <span class="nt">-v</span> ^install | <span class="nb">sed</span> <span class="s1">'s,selinux --disabled,selinux --permissive,'</span> | <span class="nb">sed</span> <span class="s1">'s,rootpw --iscrypted \$default_password_crypted,rootpw --iscrypted \$default_password_crypted\nuser --groups=wheel --name=fedora --password=\$default_password_crypted --iscrypted --gecos="fedora",'</span> | <span class="nb">tee</span> /var/lib/cobbler/templates/Fedora34.ks
</code></pre></div></div> <blockquote> <p>The kickstart file used to install any Fedora 34 system, whether manually through the GUI installer or automated, can be found at <code class="language-plaintext highlighter-rouge">/root/anaconda-ks.cfg</code> on the resulting system.</p> </blockquote> <p>Set the new kickstart file as the Fedora 34 Cobbler Profile’s autoinstall file:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cobbler profile edit <span class="nt">--name</span> Fedora34-x86_64 <span class="nt">--autoinstall</span> Fedora34.ks
</code></pre></div></div> <p>Now, create the <strong>PXE Client</strong> VirtualBox VM according to the specs described in the <strong>Environment</strong> section above and set the VM to boot from “Hard Drive” and “Network” only, in that order</p> <blockquote> <p>At this point, you may run the <code class="language-plaintext highlighter-rouge">systemctl restart cobblerd</code> command, followed by <code class="language-plaintext highlighter-rouge">cobbler sync</code> on the Cobbler server, then start the <strong>PXE Client</strong> VM and it should boot via PXE, where you should see the option to boot to the Fedora 34 Cobbler Profile (you may need to manually boot from PXE using the UEFI menu if the VM is set to use EFI firmware).</p> </blockquote> <p>Finally, create a new Cobbler System, replacing the <em>“aa:bb:cc:dd:ee:ff”</em> with the Mac Address of the VM created above, and syncing up Cobbler:</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cobbler system add <span class="nt">--name</span> Fedora34 <span class="nt">--profile</span> Fedora34-x86_64 <span class="nt">--filename</span> <span class="s2">"grub/grubx64.efi"</span> <span class="nt">--netboot-enabled</span> <span class="nb">true</span> <span class="nt">--hostname</span> fedora34 <span class="nt">--interface</span> enp0s3 <span class="nt">--static</span> <span class="nb">true</span> <span class="nt">--mac-address</span> <span class="s2">"aa:bb:cc:dd:ee:ff"</span> <span class="nt">--ip-address</span> 10.0.0.11 <span class="nt">--gateway</span> 10.0.0.1 <span class="nt">--netmask</span> 255.255.255.0 <span class="nt">--name-servers</span> <span class="s2">"10.0.0.1"</span>
systemctl restart cobblerd <span class="o">&amp;&amp;</span> <span class="nb">sleep </span>10
cobbler <span class="nb">sync</span>
</code></pre></div></div> <p>The “PXE Client” VM can now be powered on, and should automatically boot to PXE and install Fedora 34 to the VM HDD using the “Fedora34.ks” kickstart file created above.</p> <blockquote> <p>The newly installed system will have the password “cobbler” for both users “root” and “fedora” which is configurable through the <code class="language-plaintext highlighter-rouge">default_password_crypted</code> setting in <code class="language-plaintext highlighter-rouge">/etc/cobbler/settings.yaml</code> as well as the kickstart file created above.</p> </blockquote> <h3 id="importing-and-deploying-fedora-37-server"><strong>Importing and deploying Fedora 37 Server</strong></h3> <p>Take similar steps as above to import and autoinstall Fedora 37 Server</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mount <span class="nt">-t</span> iso9660 <span class="nt">-o</span> loop,ro /home/fedora/Downloads/Fedora-Server-dvd-x86_64-37-1.7.iso /mnt/Fedora
cobbler import <span class="nt">--name</span><span class="o">=</span>Fedora37 <span class="nt">--arch</span><span class="o">=</span>x86_64 <span class="nt">--path</span><span class="o">=</span>/mnt/Fedora
cobbler distro edit <span class="nt">--name</span> Fedora37-x86_64 <span class="nt">--kernel-options</span> <span class="s2">""</span>
<span class="nb">cat</span> /var/lib/cobbler/templates/sample.ks | <span class="nb">grep</span> <span class="nt">-v</span> <span class="s2">"</span><span class="se">\-</span><span class="s2">-useshadow"</span> | <span class="nb">grep</span> <span class="nt">-v</span> ^install | <span class="nb">sed</span> <span class="s1">'s,selinux --disabled,selinux --permissive,'</span> | <span class="nb">sed</span> <span class="s1">'s,rootpw --iscrypted \$default_password_crypted,rootpw --iscrypted \$default_password_crypted\nuser --groups=wheel --name=fedora --password=\$default_password_crypted --iscrypted --gecos="fedora",'</span> | <span class="nb">tee</span> /var/lib/cobbler/templates/Fedora37.ks
cobbler profile edit <span class="nt">--name</span> Fedora37-x86_64 <span class="nt">--autoinstall</span> Fedora37.ks
cobbler system add <span class="nt">--name</span> Fedora37 <span class="nt">--profile</span> Fedora37-x86_64 <span class="nt">--filename</span> <span class="s2">"grub/grubx64.efi"</span> <span class="nt">--netboot-enabled</span> <span class="nb">true</span> <span class="nt">--hostname</span> fedora37 <span class="nt">--interface</span> enp0s3 <span class="nt">--static</span> <span class="nb">true</span> <span class="nt">--mac-address</span> <span class="s2">"aa:bb:cc:dd:ee:ff"</span> <span class="nt">--ip-address</span> 10.0.0.12 <span class="nt">--gateway</span> 10.0.0.1 <span class="nt">--netmask</span> 255.255.255.0 <span class="nt">--name-servers</span> <span class="s2">"10.0.0.1"</span>
systemctl restart cobblerd <span class="o">&amp;&amp;</span> <span class="nb">sleep </span>10
cobbler <span class="nb">sync</span>
</code></pre></div></div> <h3 id="troubleshooting"><strong>Troubleshooting</strong></h3> <p>here are some helpful troubleshooting commands</p> <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>man cobbler
man dhcpd
man tftp
man httpd
man selinux
man firewalld

cobbler <span class="nt">--help</span>
cobbler distro edit <span class="nt">--help</span>
cobbler profile edit <span class="nt">--help</span>
cobbler system edit <span class="nt">--help</span>

systemctl status cobblerd
systemctl status dhcpd
systemctl status tftp
systemctl status httpd

journalctl <span class="nt">-eu</span> cobblerd
journalctl <span class="nt">-eu</span> dhcpd
journalctl <span class="nt">-eu</span> tftp
journalctl <span class="nt">-eu</span> httpd

<span class="nb">cat</span> /var/log/httpd/error_log

<span class="nb">cat</span> /var/log/audit/audit.log | <span class="nb">grep </span>AVC

cobbler distro report

cobbler profile report

cobbler system report

<span class="nb">cat</span> /etc/dhcp/dhcpd.conf

<span class="nb">cat</span> /var/lib/tftpboot/grub/x86_64_menu_items.cfg
<span class="nb">cat</span> /var/lib/tftpboot/pxelinux.cfg/default

<span class="nb">cat</span> /etc/httpd/conf/httpd.conf
<span class="nb">cat</span> /etc/httpd/conf.d/cobbler.conf
</code></pre></div></div>]]></content><author><name>Sus-Admin</name></author><summary type="html"><![CDATA[This guide is intended to accompany and extend the official Cobbler Installation and Quick Start guides.]]></summary></entry><entry><title type="html">Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra</title><link href="https://sus-admin.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/" rel="alternate" type="text/html" title="Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra"/><published>2024-05-14T00:00:00+00:00</published><updated>2024-05-14T00:00:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/google-gemini-updates-flash-15-gemma-2-and-project-astra/"><![CDATA[]]></content><author><name></name></author><summary type="html"><![CDATA[We’re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.]]></summary></entry><entry><title type="html">a post with tabs</title><link href="https://sus-admin.github.io/blog/2024/tabs/" rel="alternate" type="text/html" title="a post with tabs"/><published>2024-05-01T00:32:13+00:00</published><updated>2024-05-01T00:32:13+00:00</updated><id>https://sus-admin.github.io/blog/2024/tabs</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/tabs/"><![CDATA[<p>This is how a post with <a href="https://github.com/Ovski4/jekyll-tabs">tabs</a> looks like. Note that the tabs could be used for different purposes, not only for code.</p> <h2 id="first-tabs">First tabs</h2> <p>To add tabs, use the following syntax:</p> <div class="language-liquid highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">{%</span><span class="w"> </span><span class="nt">tabs</span><span class="w"> </span><span class="nv">group-name</span><span class="w"> </span><span class="cp">%}</span>

<span class="cp">{%</span><span class="w"> </span><span class="nt">tab</span><span class="w"> </span><span class="nv">group-name</span><span class="w"> </span><span class="nv">tab-name-1</span><span class="w"> </span><span class="cp">%}</span>

Content 1

<span class="cp">{%</span><span class="w"> </span><span class="nt">endtab</span><span class="w"> </span><span class="cp">%}</span>

<span class="cp">{%</span><span class="w"> </span><span class="nt">tab</span><span class="w"> </span><span class="nv">group-name</span><span class="w"> </span><span class="nv">tab-name-2</span><span class="w"> </span><span class="cp">%}</span>

Content 2

<span class="cp">{%</span><span class="w"> </span><span class="nt">endtab</span><span class="w"> </span><span class="cp">%}</span>

<span class="cp">{%</span><span class="w"> </span><span class="nt">endtabs</span><span class="w"> </span><span class="cp">%}</span>
</code></pre></div></div> <p>With this you can generate visualizations like:</p> <ul id="log" class="tab" data-tab="0118d1ce-144a-4a20-a72a-7d447d507331" data-name="log"> <li class="active" id="log-php"> <a href="#">php </a> </li> <li id="log-js"> <a href="#">js </a> </li> <li id="log-ruby"> <a href="#">ruby </a> </li> </ul> <ul class="tab-content" id="0118d1ce-144a-4a20-a72a-7d447d507331" data-name="log"> <li class="active"> <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">var_dump</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">);</span>
</code></pre></div></div> </li> <li> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">hello</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div> </li> <li> <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">pputs</span> <span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span>
</code></pre></div></div> </li> </ul> <h2 id="another-example">Another example</h2> <ul id="data-struct" class="tab" data-tab="0ef0af5e-02d6-4ae6-955f-d56812117ff5" data-name="data-struct"> <li class="active" id="data-struct-yaml"> <a href="#">yaml </a> </li> <li id="data-struct-json"> <a href="#">json </a> </li> </ul> <ul class="tab-content" id="0ef0af5e-02d6-4ae6-955f-d56812117ff5" data-name="data-struct"> <li class="active"> <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">hello</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">whatsup"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">hi"</span>
</code></pre></div></div> </li> <li> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"hello"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"whatsup"</span><span class="p">,</span><span class="w"> </span><span class="s2">"hi"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> </li> </ul> <h2 id="tabs-for-something-else">Tabs for something else</h2> <ul id="something-else" class="tab" data-tab="52d206fc-a0f6-45b8-9fda-23b77897676b" data-name="something-else"> <li class="active" id="something-else-text"> <a href="#">text </a> </li> <li id="something-else-quote"> <a href="#">quote </a> </li> <li id="something-else-list"> <a href="#">list </a> </li> </ul> <ul class="tab-content" id="52d206fc-a0f6-45b8-9fda-23b77897676b" data-name="something-else"> <li class="active"> <p>Regular text</p> </li> <li> <blockquote> <p>A quote</p> </blockquote> </li> <li> <p>Hipster list</p> <ul> <li>brunch</li> <li>fixie</li> <li>raybans</li> <li>messenger bag</li> </ul> </li> </ul>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="code"/><summary type="html"><![CDATA[this is what included tabs in a post could look like]]></summary></entry><entry><title type="html">a post with typograms</title><link href="https://sus-admin.github.io/blog/2024/typograms/" rel="alternate" type="text/html" title="a post with typograms"/><published>2024-04-29T23:36:10+00:00</published><updated>2024-04-29T23:36:10+00:00</updated><id>https://sus-admin.github.io/blog/2024/typograms</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/typograms/"><![CDATA[<p>This is an example post with some <a href="https://github.com/google/typograms/">typograms</a> code.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">typograms
</span><span class="sb">+----+
|    |---&gt; My first diagram!
+----+</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-typograms">+----+
|    |---&gt; My first diagram!
+----+
</code></pre> <p>Another example:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">typograms
</span><span class="sb">.------------------------.
|.----------------------.|
||"https://example.com" ||
|'----------------------'|
| ______________________ |
||                      ||
||   Welcome!           ||
||                      ||
||                      ||
||  .----------------.  ||
||  | username       |  ||
||  '----------------'  ||
||  .----------------.  ||
||  |"*******"       |  ||
||  '----------------'  ||
||                      ||
||  .----------------.  ||
||  |   "Sign-up"    |  ||
||  '----------------'  ||
||                      ||
|+----------------------+|
.------------------------.</span>
<span class="p">```</span>
</code></pre></div></div> <p>which generates:</p> <pre><code class="language-typograms">.------------------------.
|.----------------------.|
||"https://example.com" ||
|'----------------------'|
| ______________________ |
||                      ||
||   Welcome!           ||
||                      ||
||                      ||
||  .----------------.  ||
||  | username       |  ||
||  '----------------'  ||
||  .----------------.  ||
||  |"*******"       |  ||
||  '----------------'  ||
||                      ||
||  .----------------.  ||
||  |   "Sign-up"    |  ||
||  '----------------'  ||
||                      ||
|+----------------------+|
.------------------------.
</code></pre> <p>For more examples, check out the <a href="https://google.github.io/typograms/#examples">typograms documentation</a>.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="diagrams"/><summary type="html"><![CDATA[this is what included typograms code could look like]]></summary></entry><entry><title type="html">a post that can be cited</title><link href="https://sus-admin.github.io/blog/2024/post-citation/" rel="alternate" type="text/html" title="a post that can be cited"/><published>2024-04-28T15:06:00+00:00</published><updated>2024-04-28T15:06:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/post-citation</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/post-citation/"><![CDATA[<p>This is an example post that can be cited. The content of the post ends here, while the citation information is automatically provided below. The only thing needed is for you to set the <code class="language-plaintext highlighter-rouge">citation</code> key in the front matter to <code class="language-plaintext highlighter-rouge">true</code>.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="citation"/><summary type="html"><![CDATA[this is what a post that can be cited looks like]]></summary></entry><entry><title type="html">a post with pseudo code</title><link href="https://sus-admin.github.io/blog/2024/pseudocode/" rel="alternate" type="text/html" title="a post with pseudo code"/><published>2024-04-15T00:01:00+00:00</published><updated>2024-04-15T00:01:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/pseudocode</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/pseudocode/"><![CDATA[<p>This is an example post with some pseudo code rendered by <a href="https://github.com/SaswatPadhi/pseudocode.js">pseudocode</a>. The example presented here is the same as the one in the <a href="https://saswat.padhi.me/pseudocode.js/">pseudocode.js</a> documentation, with only one simple but important change: everytime you would use <code class="language-plaintext highlighter-rouge">$</code>, you should use <code class="language-plaintext highlighter-rouge">$$</code> instead. Also, note that the <code class="language-plaintext highlighter-rouge">pseudocode</code> key in the front matter is set to <code class="language-plaintext highlighter-rouge">true</code> to enable the rendering of pseudo code. As an example, using this code:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">pseudocode
</span><span class="sb">% This quicksort algorithm is extracted from Chapter 7, Introduction to Algorithms (3rd edition)
\begin{algorithm}
\caption{Quicksort}
\begin{algorithmic}
\PROCEDURE{Quicksort}{$$A, p, r$$}
    \IF{$$p &lt; r$$}
        \STATE $$q = $$ \CALL{Partition}{$$A, p, r$$}
        \STATE \CALL{Quicksort}{$$A, p, q - 1$$}
        \STATE \CALL{Quicksort}{$$A, q + 1, r$$}
    \ENDIF
\ENDPROCEDURE
\PROCEDURE{Partition}{$$A, p, r$$}
    \STATE $$x = A[r]$$
    \STATE $$i = p - 1$$
    \FOR{$$j = p$$ \TO $$r - 1$$}
        \IF{$$A[j] &lt; x$$}
            \STATE $$i = i + 1$$
            \STATE exchange
            $$A[i]$$ with $$A[j]$$
        \ENDIF
        \STATE exchange $$A[i]$$ with $$A[r]$$
    \ENDFOR
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Generates:</p> <pre><code class="language-pseudocode">% This quicksort algorithm is extracted from Chapter 7, Introduction to Algorithms (3rd edition)
\begin{algorithm}
\caption{Quicksort}
\begin{algorithmic}
\PROCEDURE{Quicksort}{$$A, p, r$$}
    \IF{$$p &lt; r$$}
        \STATE $$q = $$ \CALL{Partition}{$$A, p, r$$}
        \STATE \CALL{Quicksort}{$$A, p, q - 1$$}
        \STATE \CALL{Quicksort}{$$A, q + 1, r$$}
    \ENDIF
\ENDPROCEDURE
\PROCEDURE{Partition}{$$A, p, r$$}
    \STATE $$x = A[r]$$
    \STATE $$i = p - 1$$
    \FOR{$$j = p$$ \TO $$r - 1$$}
        \IF{$$A[j] &lt; x$$}
            \STATE $$i = i + 1$$
            \STATE exchange
            $$A[i]$$ with $$A[j]$$
        \ENDIF
        \STATE exchange $$A[i]$$ with $$A[r]$$
    \ENDFOR
\ENDPROCEDURE
\end{algorithmic}
\end{algorithm}
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="code"/><summary type="html"><![CDATA[this is what included pseudo code could look like]]></summary></entry><entry><title type="html">a post with code diff</title><link href="https://sus-admin.github.io/blog/2024/code-diff/" rel="alternate" type="text/html" title="a post with code diff"/><published>2024-01-27T19:22:00+00:00</published><updated>2024-01-27T19:22:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/code-diff</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/code-diff/"><![CDATA[<p>You can display diff code by using the regular markdown syntax:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">diff
</span><span class="gh">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
</span><span class="gd">--- a/sample.js
</span><span class="gi">+++ b/sample.js
</span><span class="p">@@ -1 +1 @@</span>
<span class="gd">-console.log("Hello World!")
</span><span class="gi">+console.log("Hello from Diff2Html!")</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gh">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
</span><span class="gd">--- a/sample.js
</span><span class="gi">+++ b/sample.js
</span><span class="p">@@ -1 +1 @@</span>
<span class="gd">-console.log("Hello World!")
</span><span class="gi">+console.log("Hello from Diff2Html!")
</span></code></pre></div></div> <p>But this is difficult to read, specially if you have a large diff. You can use <a href="https://diff2html.xyz/">diff2html</a> to display a more readable version of the diff. For this, just use <code class="language-plaintext highlighter-rouge">diff2html</code> instead of <code class="language-plaintext highlighter-rouge">diff</code> for the code block language:</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">diff2html
</span><span class="sb">diff --git a/sample.js b/sample.js
index 0000001..0ddf2ba
--- a/sample.js
+++ b/sample.js
@@ -1 +1 @@
-console.log("Hello World!")
+console.log("Hello from Diff2Html!")</span>
<span class="p">```</span>
</code></pre></div></div> <p>If we use a longer example, for example <a href="https://github.com/rtfpessoa/diff2html/commit/c2c253d3e3f8b8b267f551e659f72b44ca2ac927">this commit from diff2html</a>, it will generate the following output:</p> <pre><code class="language-diff2html">From 2aaae31cc2a37bfff83430c2c914b140bee59b6a Mon Sep 17 00:00:00 2001
From: Rodrigo Fernandes &lt;rtfrodrigo@gmail.com&gt;
Date: Sun, 9 Oct 2016 16:41:54 +0100
Subject: [PATCH 1/2] Initial template override support

---
 scripts/hulk.js                    |  4 ++--
 src/diff2html.js                   |  3 +--
 src/file-list-printer.js           | 11 ++++++++---
 src/hoganjs-utils.js               | 29 +++++++++++++++++------------
 src/html-printer.js                |  6 ++++++
 src/line-by-line-printer.js        |  6 +++++-
 src/side-by-side-printer.js        |  6 +++++-
 test/file-list-printer-tests.js    |  2 +-
 test/hogan-cache-tests.js          | 18 +++++++++++++++---
 test/line-by-line-tests.js         |  3 +--
 test/side-by-side-printer-tests.js |  3 +--
 11 files changed, 62 insertions(+), 29 deletions(-)

diff --git a/scripts/hulk.js b/scripts/hulk.js
index 5a793c18..a4b1a4d5 100755
--- a/scripts/hulk.js
+++ b/scripts/hulk.js
@@ -173,11 +173,11 @@ function namespace(name) {
 // write a template foreach file that matches template extension
 templates = extractFiles(options.argv.remain)
   .map(function(file) {
-    var openedFile = fs.readFileSync(file, 'utf-8');
+    var openedFile = fs.readFileSync(file, 'utf-8').trim();
     var name;
     if (!openedFile) return;
     name = namespace(path.basename(file).replace(/\..*$/, ''));
-    openedFile = removeByteOrderMark(openedFile.trim());
+    openedFile = removeByteOrderMark(openedFile);
     openedFile = wrap(file, name, openedFile);
     if (!options.outputdir) return openedFile;
     fs.writeFileSync(path.join(options.outputdir, name + '.js')
diff --git a/src/diff2html.js b/src/diff2html.js
index 21b0119e..64e138f5 100644
--- a/src/diff2html.js
+++ b/src/diff2html.js
@@ -7,7 +7,6 @@

 (function() {
   var diffParser = require('./diff-parser.js').DiffParser;
-  var fileLister = require('./file-list-printer.js').FileListPrinter;
   var htmlPrinter = require('./html-printer.js').HtmlPrinter;

   function Diff2Html() {
@@ -43,7 +42,7 @@

     var fileList = '';
     if (configOrEmpty.showFiles === true) {
-      fileList = fileLister.generateFileList(diffJson, configOrEmpty);
+      fileList = htmlPrinter.generateFileListSummary(diffJson, configOrEmpty);
     }

     var diffOutput = '';
diff --git a/src/file-list-printer.js b/src/file-list-printer.js
index e408d9b2..1e0a2c61 100644
--- a/src/file-list-printer.js
+++ b/src/file-list-printer.js
@@ -8,11 +8,16 @@
 (function() {
   var printerUtils = require('./printer-utils.js').PrinterUtils;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var baseTemplatesPath = 'file-summary';
   var iconsBaseTemplatesPath = 'icon';

-  function FileListPrinter() {
+  function FileListPrinter(config) {
+    this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   FileListPrinter.prototype.generateFileList = function(diffFiles) {
@@ -38,5 +43,5 @@
     });
   };

-  module.exports.FileListPrinter = new FileListPrinter();
+  module.exports.FileListPrinter = FileListPrinter;
 })();
diff --git a/src/hoganjs-utils.js b/src/hoganjs-utils.js
index 9949e5fa..0dda08d7 100644
--- a/src/hoganjs-utils.js
+++ b/src/hoganjs-utils.js
@@ -8,18 +8,19 @@
 (function() {
   var fs = require('fs');
   var path = require('path');
-
   var hogan = require('hogan.js');

   var hoganTemplates = require('./templates/diff2html-templates.js');

-  var templatesPath = path.resolve(__dirname, 'templates');
+  var extraTemplates;

-  function HoganJsUtils() {
+  function HoganJsUtils(configuration) {
+    this.config = configuration || {};
+    extraTemplates = this.config.templates || {};
   }

-  HoganJsUtils.prototype.render = function(namespace, view, params, configuration) {
-    var template = this.template(namespace, view, configuration);
+  HoganJsUtils.prototype.render = function(namespace, view, params) {
+    var template = this.template(namespace, view);
     if (template) {
       return template.render(params);
     }
@@ -27,17 +28,16 @@
     return null;
   };

-  HoganJsUtils.prototype.template = function(namespace, view, configuration) {
-    var config = configuration || {};
+  HoganJsUtils.prototype.template = function(namespace, view) {
     var templateKey = this._templateKey(namespace, view);

-    return this._getTemplate(templateKey, config);
+    return this._getTemplate(templateKey);
   };

-  HoganJsUtils.prototype._getTemplate = function(templateKey, config) {
+  HoganJsUtils.prototype._getTemplate = function(templateKey) {
     var template;

-    if (!config.noCache) {
+    if (!this.config.noCache) {
       template = this._readFromCache(templateKey);
     }

@@ -53,6 +53,7 @@

     try {
       if (fs.readFileSync) {
+        var templatesPath = path.resolve(__dirname, 'templates');
         var templatePath = path.join(templatesPath, templateKey);
         var templateContent = fs.readFileSync(templatePath + '.mustache', 'utf8');
         template = hogan.compile(templateContent);
@@ -66,12 +67,16 @@
   };

   HoganJsUtils.prototype._readFromCache = function(templateKey) {
-    return hoganTemplates[templateKey];
+    return extraTemplates[templateKey] || hoganTemplates[templateKey];
   };

   HoganJsUtils.prototype._templateKey = function(namespace, view) {
     return namespace + '-' + view;
   };

-  module.exports.HoganJsUtils = new HoganJsUtils();
+  HoganJsUtils.prototype.compile = function(templateStr) {
+    return hogan.compile(templateStr);
+  };
+
+  module.exports.HoganJsUtils = HoganJsUtils;
 })();
diff --git a/src/html-printer.js b/src/html-printer.js
index 585d5b66..13f83047 100644
--- a/src/html-printer.js
+++ b/src/html-printer.js
@@ -8,6 +8,7 @@
 (function() {
   var LineByLinePrinter = require('./line-by-line-printer.js').LineByLinePrinter;
   var SideBySidePrinter = require('./side-by-side-printer.js').SideBySidePrinter;
+  var FileListPrinter = require('./file-list-printer.js').FileListPrinter;

   function HtmlPrinter() {
   }
@@ -22,5 +23,10 @@
     return sideBySidePrinter.generateSideBySideJsonHtml(diffFiles);
   };

+  HtmlPrinter.prototype.generateFileListSummary = function(diffJson, config) {
+    var fileListPrinter = new FileListPrinter(config);
+    return fileListPrinter.generateFileList(diffJson);
+  };
+
   module.exports.HtmlPrinter = new HtmlPrinter();
 })();
diff --git a/src/line-by-line-printer.js b/src/line-by-line-printer.js
index b07eb53c..d230bedd 100644
--- a/src/line-by-line-printer.js
+++ b/src/line-by-line-printer.js
@@ -11,7 +11,8 @@
   var utils = require('./utils.js').Utils;
   var Rematch = require('./rematch.js').Rematch;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var genericTemplatesPath = 'generic';
   var baseTemplatesPath = 'line-by-line';
   var iconsBaseTemplatesPath = 'icon';
@@ -19,6 +20,9 @@

   function LineByLinePrinter(config) {
     this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   LineByLinePrinter.prototype.makeFileDiffHtml = function(file, diffs) {
diff --git a/src/side-by-side-printer.js b/src/side-by-side-printer.js
index bbf1dc8d..5e3033b3 100644
--- a/src/side-by-side-printer.js
+++ b/src/side-by-side-printer.js
@@ -11,7 +11,8 @@
   var utils = require('./utils.js').Utils;
   var Rematch = require('./rematch.js').Rematch;

-  var hoganUtils = require('./hoganjs-utils.js').HoganJsUtils;
+  var hoganUtils;
+
   var genericTemplatesPath = 'generic';
   var baseTemplatesPath = 'side-by-side';
   var iconsBaseTemplatesPath = 'icon';
@@ -26,6 +27,9 @@

   function SideBySidePrinter(config) {
     this.config = config;
+
+    var HoganJsUtils = require('./hoganjs-utils.js').HoganJsUtils;
+    hoganUtils = new HoganJsUtils(config);
   }

   SideBySidePrinter.prototype.makeDiffHtml = function(file, diffs) {
diff --git a/test/file-list-printer-tests.js b/test/file-list-printer-tests.js
index a502a46f..60ea3208 100644
--- a/test/file-list-printer-tests.js
+++ b/test/file-list-printer-tests.js
@@ -1,6 +1,6 @@
 var assert = require('assert');

-var fileListPrinter = require('../src/file-list-printer.js').FileListPrinter;
+var fileListPrinter = new (require('../src/file-list-printer.js').FileListPrinter)();

 describe('FileListPrinter', function() {
   describe('generateFileList', function() {
diff --git a/test/hogan-cache-tests.js b/test/hogan-cache-tests.js
index 190bf6f8..3bb754ac 100644
--- a/test/hogan-cache-tests.js
+++ b/test/hogan-cache-tests.js
@@ -1,6 +1,6 @@
 var assert = require('assert');

-var HoganJsUtils = require('../src/hoganjs-utils.js').HoganJsUtils;
+var HoganJsUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)();
 var diffParser = require('../src/diff-parser.js').DiffParser;

 describe('HoganJsUtils', function() {
@@ -21,16 +21,28 @@ describe('HoganJsUtils', function() {
       });
       assert.equal(emptyDiffHtml, result);
     });
+
     it('should render view without cache', function() {
       var result = HoganJsUtils.render('generic', 'empty-diff', {
         contentClass: 'd2h-code-line',
         diffParser: diffParser
       }, {noCache: true});
-      assert.equal(emptyDiffHtml + '\n', result);
+      assert.equal(emptyDiffHtml, result);
     });
+
     it('should return null if template is missing', function() {
-      var result = HoganJsUtils.render('generic', 'missing-template', {}, {noCache: true});
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)({noCache: true});
+      var result = hoganUtils.render('generic', 'missing-template', {});
       assert.equal(null, result);
     });
+
+    it('should allow templates to be overridden', function() {
+      var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');
+
+      var config = {templates: {'generic-empty-diff': emptyDiffTemplate}};
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
   });
 });
diff --git a/test/line-by-line-tests.js b/test/line-by-line-tests.js
index 1cd92073..8869b3df 100644
--- a/test/line-by-line-tests.js
+++ b/test/line-by-line-tests.js
@@ -14,7 +14,7 @@ describe('LineByLinePrinter', function() {
         '            File without changes\n' +
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
-        '&lt;/tr&gt;\n';
+        '&lt;/tr&gt;';

       assert.equal(expected, fileHtml);
     });
@@ -422,7 +422,6 @@ describe('LineByLinePrinter', function() {
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
         '&lt;/tr&gt;\n' +
-        '\n' +
         '                &lt;/tbody&gt;\n' +
         '            &lt;/table&gt;\n' +
         '        &lt;/div&gt;\n' +
diff --git a/test/side-by-side-printer-tests.js b/test/side-by-side-printer-tests.js
index 76625f8e..771daaa5 100644
--- a/test/side-by-side-printer-tests.js
+++ b/test/side-by-side-printer-tests.js
@@ -14,7 +14,7 @@ describe('SideBySidePrinter', function() {
         '            File without changes\n' +
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
-        '&lt;/tr&gt;\n';
+        '&lt;/tr&gt;';

       assert.equal(expectedRight, fileHtml.right);
       assert.equal(expectedLeft, fileHtml.left);
@@ -324,7 +324,6 @@ describe('SideBySidePrinter', function() {
         '        &lt;/div&gt;\n' +
         '    &lt;/td&gt;\n' +
         '&lt;/tr&gt;\n' +
-        '\n' +
         '                    &lt;/tbody&gt;\n' +
         '                &lt;/table&gt;\n' +
         '            &lt;/div&gt;\n' +

From f3cadb96677d0eb82fc2752dc3ffbf35ca9b5bdb Mon Sep 17 00:00:00 2001
From: Rodrigo Fernandes &lt;rtfrodrigo@gmail.com&gt;
Date: Sat, 15 Oct 2016 13:21:22 +0100
Subject: [PATCH 2/2] Allow uncompiled templates

---
 README.md                 |  3 +++
 src/hoganjs-utils.js      |  7 +++++++
 test/hogan-cache-tests.js | 24 +++++++++++++++++++++++-
 3 files changed, 33 insertions(+), 1 deletion(-)

diff --git a/README.md b/README.md
index 132c8a28..46909f25 100644
--- a/README.md
+++ b/README.md
@@ -98,6 +98,9 @@ The HTML output accepts a Javascript object with configuration. Possible options
   - `synchronisedScroll`: scroll both panes in side-by-side mode: `true` or `false`, default is `false`
   - `matchWordsThreshold`: similarity threshold for word matching, default is 0.25
   - `matchingMaxComparisons`: perform at most this much comparisons for line matching a block of changes, default is `2500`
+  - `templates`: object with previously compiled templates to replace parts of the html
+  - `rawTemplates`: object with raw not compiled templates to replace parts of the html
+  &gt; For more information regarding the possible templates look into [src/templates](https://github.com/rtfpessoa/diff2html/tree/master/src/templates)

 ## Diff2HtmlUI Helper

diff --git a/src/hoganjs-utils.js b/src/hoganjs-utils.js
index 0dda08d7..b2e9c275 100644
--- a/src/hoganjs-utils.js
+++ b/src/hoganjs-utils.js
@@ -17,6 +17,13 @@
   function HoganJsUtils(configuration) {
     this.config = configuration || {};
     extraTemplates = this.config.templates || {};
+
+    var rawTemplates = this.config.rawTemplates || {};
+    for (var templateName in rawTemplates) {
+      if (rawTemplates.hasOwnProperty(templateName)) {
+        if (!extraTemplates[templateName]) extraTemplates[templateName] = this.compile(rawTemplates[templateName]);
+      }
+    }
   }

   HoganJsUtils.prototype.render = function(namespace, view, params) {
diff --git a/test/hogan-cache-tests.js b/test/hogan-cache-tests.js
index 3bb754ac..a34839c0 100644
--- a/test/hogan-cache-tests.js
+++ b/test/hogan-cache-tests.js
@@ -36,7 +36,7 @@ describe('HoganJsUtils', function() {
       assert.equal(null, result);
     });

-    it('should allow templates to be overridden', function() {
+    it('should allow templates to be overridden with compiled templates', function() {
       var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');

       var config = {templates: {'generic-empty-diff': emptyDiffTemplate}};
@@ -44,5 +44,27 @@ describe('HoganJsUtils', function() {
       var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
       assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
     });
+
+    it('should allow templates to be overridden with uncompiled templates', function() {
+      var emptyDiffTemplate = '&lt;p&gt;&lt;/p&gt;';
+
+      var config = {rawTemplates: {'generic-empty-diff': emptyDiffTemplate}};
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
+
+    it('should allow templates to be overridden giving priority to compiled templates', function() {
+      var emptyDiffTemplate = HoganJsUtils.compile('&lt;p&gt;&lt;/p&gt;');
+      var emptyDiffTemplateUncompiled = '&lt;p&gt;Not used!&lt;/p&gt;';
+
+      var config = {
+        templates: {'generic-empty-diff': emptyDiffTemplate},
+        rawTemplates: {'generic-empty-diff': emptyDiffTemplateUncompiled}
+      };
+      var hoganUtils = new (require('../src/hoganjs-utils.js').HoganJsUtils)(config);
+      var result = hoganUtils.render('generic', 'empty-diff', {myName: 'Rodrigo Fernandes'});
+      assert.equal('&lt;p&gt;Rodrigo Fernandes&lt;/p&gt;', result);
+    });
   });
 });
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="code"/><summary type="html"><![CDATA[this is how you can display code diffs]]></summary></entry><entry><title type="html">a post with advanced image components</title><link href="https://sus-admin.github.io/blog/2024/advanced-images/" rel="alternate" type="text/html" title="a post with advanced image components"/><published>2024-01-27T11:46:00+00:00</published><updated>2024-01-27T11:46:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/advanced-images</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/advanced-images/"><![CDATA[<p>This is an example post with advanced image components.</p> <h2 id="image-slider">Image Slider</h2> <p>This is a simple image slider. It uses the <a href="https://swiperjs.com/">Swiper</a> library. Check the <a href="https://swiperjs.com/demos">examples page</a> for more information of what you can achieve with it.</p> <swiper-container keyboard="true" navigation="true" pagination="true" pagination-clickable="true" pagination-dynamic-bullets="true" rewind="true"> <swiper-slide> <figure> <picture> <img src="/assets/img/9.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <img src="/assets/img/7.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <img src="/assets/img/8.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <img src="/assets/img/10.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> <swiper-slide> <figure> <picture> <img src="/assets/img/12.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </swiper-slide> </swiper-container> <h2 id="image-comparison-slider">Image Comparison Slider</h2> <p>This is a simple image comparison slider. It uses the <a href="https://img-comparison-slider.sneas.io/">img-comparison-slider</a> library. Check the <a href="https://img-comparison-slider.sneas.io/examples.html">examples page</a> for more information of what you can achieve with it.</p> <img-comparison-slider> <figure slot="first"> <picture> <img src="/assets/img/prof_pic.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> <figure slot="second"> <picture> <img src="/assets/img/prof_pic_color.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="lazy" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"/> </picture> </figure> </img-comparison-slider>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="images"/><summary type="html"><![CDATA[this is what advanced image components could look like]]></summary></entry><entry><title type="html">a post with vega lite</title><link href="https://sus-admin.github.io/blog/2024/vega-lite/" rel="alternate" type="text/html" title="a post with vega lite"/><published>2024-01-27T00:20:00+00:00</published><updated>2024-01-27T00:20:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/vega-lite</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/vega-lite/"><![CDATA[<p>This is an example post with some <a href="https://vega.github.io/vega-lite/">vega lite</a> code.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">vega_lite
</span><span class="sb">{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A dot plot showing each movie in the database, and the difference from the average movie rating. The display is sorted by year to visualize everything in sequential order. The graph is for all Movies before 2019.",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "Rating Delta"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "Rating Delta"
    }
  }
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-vega_lite">{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "A dot plot showing each movie in the database, and the difference from the average movie rating. The display is sorted by year to visualize everything in sequential order. The graph is for all Movies before 2019.",
  "data": {
    "url": "https://raw.githubusercontent.com/vega/vega/main/docs/data/movies.json"
  },
  "transform": [
    {"filter": "datum['IMDB Rating'] != null"},
    {"filter": {"timeUnit": "year", "field": "Release Date", "range": [null, 2019]}},
    {
      "joinaggregate": [{
        "op": "mean",
        "field": "IMDB Rating",
        "as": "AverageRating"
      }]
    },
    {
      "calculate": "datum['IMDB Rating'] - datum.AverageRating",
      "as": "RatingDelta"
    }
  ],
  "mark": "point",
  "encoding": {
    "x": {
      "field": "Release Date",
      "type": "temporal"
    },
    "y": {
      "field": "RatingDelta",
      "type": "quantitative",
      "title": "Rating Delta"
    },
    "color": {
      "field": "RatingDelta",
      "type": "quantitative",
      "scale": {"domainMid": 0},
      "title": "Rating Delta"
    }
  }
}
</code></pre> <p>This plot supports both light and dark themes.</p>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><summary type="html"><![CDATA[this is what included vega lite code could look like]]></summary></entry><entry><title type="html">a post with geojson</title><link href="https://sus-admin.github.io/blog/2024/geojson-map/" rel="alternate" type="text/html" title="a post with geojson"/><published>2024-01-26T17:57:00+00:00</published><updated>2024-01-26T17:57:00+00:00</updated><id>https://sus-admin.github.io/blog/2024/geojson-map</id><content type="html" xml:base="https://sus-admin.github.io/blog/2024/geojson-map/"><![CDATA[<p>This is an example post with some <a href="https://geojson.org/">geojson</a> code. The support is provided thanks to <a href="https://leafletjs.com/">Leaflet</a>. To create your own visualization, go to <a href="https://geojson.io/">geojson.io</a>.</p> <div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">```</span><span class="nl">geojson
</span><span class="sb">{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              -60.11363029935569,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -2.904625022183211
            ]
          ]
        ],
        "type": "Polygon"
      }
    }
  ]
}</span>
<span class="p">```</span>
</code></pre></div></div> <p>Which generates:</p> <pre><code class="language-geojson">{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {},
      "geometry": {
        "coordinates": [
          [
            [
              -60.11363029935569,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -3.162613728707967
            ],
            [
              -59.820894493858034,
              -2.904625022183211
            ],
            [
              -60.11363029935569,
              -2.904625022183211
            ]
          ]
        ],
        "type": "Polygon"
      }
    }
  ]
}
</code></pre>]]></content><author><name></name></author><category term="sample-posts"/><category term="formatting"/><category term="charts"/><category term="maps"/><summary type="html"><![CDATA[this is what included geojson code could look like]]></summary></entry></feed>